import{J as f,K as s,p as h}from"./index.c4f6bcfb.js";class a{#n;#e=new Map;#o;constructor(o){this.#n=new RegExp(`^${o}:`),this.#o=o,f([...s(),this])}register(o,n){this.#e.set(o,n)}find(o){return this.#e.get(o)||(this.#e.get("*")?`${this.#e.get("*")}?q=${o}`:void 0)}reverse(o){for(const[n,t]of this.#e){let i=!1;try{new URL(o).pathname===t&&(i=!0)}catch{}if(t===o||i){if(n==="*")try{return`${this.#o}:${new URL(o).searchParams.get("q")}`}catch{}return`${this.#o}:${n}`}}}get match(){return this.#n}}const c=new a("about");c.register("blank","about:blank");c.register("newTab","/internal/newTab");c.register("preferences","/internal/preferences");const g=new a("view-source");g.register("*","/internal/view-source");const r={find:e=>{for(const o of s())if(o.match.test(e)){const n=e.replace(o.match,"");return o.find(n)}},reverse:e=>{for(const o of s())if(o.reverse(e))return o.reverse(e)}},d={encode(e){return e&&encodeURIComponent(e.toString().split("").map((o,n)=>n%2?String.fromCharCode(o.charCodeAt(0)^2):o).join(""))},decode(e){if(!e)return e;let[o,...n]=e.split("?");return decodeURIComponent(o).split("").map((t,i)=>i%2?String.fromCharCode(t.charCodeAt(0)^2):t).join("")+(n.length?"?"+n.join("?"):"")}},w={google:{name:"Google",searchStr:"https://www.google.com/search?q=%s"},bing:{name:"Bing",searchStr:"https://www.bing.com/search?q=%s"},duckduckgo:{name:"DuckDuckGo",searchStr:"https://duckduckgo.com/?q=%s"},brave:{name:"Brave",searchStr:"https://search.brave.com/search?q=%s"},yahoo:{name:"Yahoo",searchStr:"https://search.yahoo.com/search?p=%s"}},p=w;function v(e){if(!("location"in globalThis))return e;const o=r.reverse(e);return r.find(e)||(o?e=o:e.startsWith(location.origin+window.__uv$config.prefix)&&(e=e.replace(location.origin+window.__uv$config.prefix,""),e=d.decode(e)),e==="about:newTab"&&(e="")),e}function u(e){let o;return window.__uv$config||window.location.reload(),r.find(e)||r.reverse(e)?o=r.find(e)||"/internal/newTab":/^https?:\/\/([^\s]+\.)+[^\s]+(:[0-65536])?$/.test(e)?o=window.__uv$config.prefix+window.__uv$config.encodeUrl(e):/^([^\s]+\.)+[^\s]+(:[0-65536])?$/.test(e)?o=window.__uv$config.prefix+window.__uv$config.encodeUrl("http://"+e):o=window.__uv$config.prefix+window.__uv$config.encodeUrl(l(e)),o}function l(e){return p[h()["search.defaults.searchEngine"]||"google"].searchStr.replace("%s",encodeURIComponent(e))}export{a as P,p as e,u as g,v as n};
